<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>我的生活1</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <link rel="shortcut icon" href="img/hkw-128_128.ico">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="//g.alicdn.com/msui/sm/0.6.2/css/sm.min.css">
    <link rel="stylesheet" href="//g.alicdn.com/msui/sm/0.6.2/css/sm-extend.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.3.5/css/swiper.min.css">
    <link rel="stylesheet" href="css/gz-custom.css" type="text/css">
    <link rel="stylesheet" href="css/layer.css" type="text/css">
</head>
<body>
<div class="page-group">
    <!--<header class="bar bar-nav gz-bar">-->
    <!--<a class="button button-link button-nav pull-left" href="/demos/card" data-transition='slide-out'>-->
    <!--<span class="icon icon-left"></span>返回</a>-->
    <!--<h1 class="title">智库工作坊</h1>-->
    <!--</header>-->
    <div class="page">
    <div class="content native-scroll">
        <div class="gz-banner">
            <img class='card-cover' src="" alt="">
        </div>
        <div class="content-padded">
            <div class="gz-describe">
                <div class="gz-headline">
                    <h3 class="gz-h3 gz-subhead gz-smsgzf"></h3>
                    <p class="gz-synopsis"></p>
                </div>
                <div class="gz-area">
                    <div class="gz-stand">
                        <div class="gz-myg-1"><span class="gz-myg-bj"> </span></div>
                        <div class="gz-myg-2"><span class="gz-myg-bj"> </span></div>
                        <div class="gz-portlets">
                            <h3 class="gz-h3 gz-subhead">
                                <span class="gz-myg-bj"><i class="iconfont">&#xe6b1;</i></span>
                                智库看台
                                <a class="gz-even-more">更多<i class="iconfont">&#xe611;</i></a></h3>
                            <div class="gz-author">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="gz-workshop-list">
            <div class="gz-h3 gz-workshop-title"><i class="iconfont zg-dian">&#xe6a2;</i>智库工作坊列表<a class="gz-even-more">更多<i class="iconfont">&#xe611;</i></a></div>
            <div class="swiper-container">
                <div id="swiper-wrapper1" class="swiper-wrapper">
                </div>
            </div>
        </div>
        <div class="gz-achievement">
            <h3 class="gz-achievement-tiet gz-h3"><i class="gz-zkcg iconfont">&#xe6b5;</i>智库成果 <a class="gz-even-more">更多<i
                    class="iconfont">&#xe611;</i></a></h3>
            <div class="gz-achievement-tbas">
                <div class="content-block">
                    <div class="buttons-row gz-hdcg-tba"></div>
                </div>
                <div class="tabs gz-tabs">
                    <div id="tab1" class="tab active">
                        <div class="content-block gz-results">

                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="gz-statistics">
            <h3 class="gz-achievement-tiet gz-h3"><i class="gz-zkcg iconfont">&#xe6b4;</i>统计
                <a class="gz-even-more" href="html/ajxj.html" external>更多<i class="iconfont">&#xe611;</i></a></h3>
            <div class="gz-statistical-graph">
                <div id="main" style="width: 100%;height:300px;"></div>
            </div>
        </div>
        <div class="gz-blogroll">
            <div class="gz-h3 gz-workshop-title"><i class="iconfont gz-blogroll-ico ">&#xe6ea;</i>友情链接</div>
                <div class="content-padded grid-demo">
                    <div class="row gz-row-demo">
                    </div>
                </div>
            </div>
        <div class="gz-organizer">
            <div class="content-padded grid-demo">
                <div class="row no-gutter">
                    <div class="col-60">
                        <h3>承办单位</h3>
                        <div class="gz-undertaker">
                        </div>
                    </div>
                    <div class="col-40">
                        <div class="gz-sponsor">
                            <h3>主办单位</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="gz-page-footer">
                <p class="gz-copyright">Powered by
                    <a href="#" target="_blank">全通云教育</a>
                    &nbsp;&nbsp;
                    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
                    document.write(unescape("%3Cspan id='cnzz_stat_icon_1274099761'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol +
                        "s13.cnzz.com/z_stat.php%3Fid%3D1274099761%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>
                    <span id="cnzz_stat_icon_1274099761">
                        <a href="http://www.cnzz.com/stat/website.php?web_id=1274099761" target="_blank" title="站长统计">
                            <img border="0" hspace="0" vspace="0" src="http://icon.cnzz.com/img/pic1.gif"></a>
                    </span>
                    <script src=" http://s13.cnzz.com/z_stat.php?id=1274099761&amp;show=pic1" type="text/javascript"></script>
                    <script src="//c.cnzz.com/core.php?web_id=1274099761&amp;show=pic1&amp;t=z" charset="utf-8" type="text/javascript"></script>
                    <a class="mlm" href="/archive/course">课程存档</a>
                    课程内容版权均归<a href="/">全通云教育科技成都有限公司</a>所有&nbsp;<a href="http://www.miibeian.gov.cn/" target="_blank">蜀ICP备16036405号-1</a></p>
        </div>
    </div>
</div>
</div>
<script type='text/javascript' src='//g.alicdn.com/sj/lib/zepto/zepto.min.js' charset='utf-8'></script>
<script type='text/javascript' src='js/jquery-3.1.0.min.js' charset='utf-8'></script>
<script type='text/javascript' src='js/main.js' charset='utf-8'></script>
<script>var Zepto = jQuery</script>
<script type='text/javascript' src='//g.alicdn.com/msui/sm/0.6.2/js/sm.min.js' charset='utf-8'></script>
<script type='text/javascript' src='//g.alicdn.com/msui/sm/0.6.2/js/sm-extend.min.js' charset='utf-8'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.3.5/js/swiper.min.js"></script>
<script src="https://cdn.bootcss.com/echarts/4.1.0.rc2/echarts-en.common.min.js"></script>
<script src="js/layer.js"></script>

<script >
  $(document).ready(function () {
    // 请求数据
    // banner
    axget('http://rap2api.taobao.org/app/mock/83971/banner', {'role':'001'},
        //请求成功返回数据
        function(data){
            if (data.code==200){
                $('.card-cover').attr('src',data.bannerimg);
            }
        },
        //请求出错了
        function(){

        }
    );
    // 什么是工作坊
    axget('http://rap2api.taobao.org/app/mock/83971/synopsis', {'role':'001'},
        //请求成功返回数据
        function(data){
            $('.gz-smsgzf').html(data.headline);
            $('.gz-synopsis').html(data.presentation)
        },
        //请求出错了
        function(){alert("请求出错了")}
    );
    //智库看台
    axget('http://rap2api.taobao.org/app/mock/83971/thinktank', {'role':'001'},
        //请求成功返回数据
        function(data){
            var i=data.wtoutia;
            var port='<div class="gz-author-portrait">' +
                '<div class="gz-author-img"><img src='+data.data[i].portrait+'></div>' +
                '<div class="gz-author-name gz-h3">'+data.data[i].name+'</div>' +
                '<div class="gz-author-date">'+data.data[i].time+'</div>' +
                '</div>' +
                '<p class="gz-stand-synopsis">'+data.data[i].title+'</p>' +
                '<div class="gz-local-color"><img src='+data.data[i].picture+'></div>'
            $('.gz-author').html(port);
        },
        //请求出错了
        function(){
            $.showPreloader('网络链接失败，请稍后再试')
        }
    );
    //工作坊列表
    axget('http://rap2api.taobao.org/app/mock/83971/workshop_list', {'role':'001'},
        //请求成功返回数据
        function(data){
            $.each(data.data, function (i, v) {
                workshopList(data.data[i]);
            });
        },
        //请求出错了
        function(){alert("请求出错了")}
    );
    function workshopList(dataList) {
        var li='<div class="swiper-slide">' +
            '<div class="gz-atelier">' +
            '<img class="gz-atelier-dt" src='+dataList.picture+'>' +
            '<div class="gz-topteacher">' +
            '<div class="gz-topteacher-img">' +
            '<img src='+dataList.headportrait+'>' +
            '</div>' +
            '<div class="gz-topteacher-name">' +
            '<h3 class="gz-h3">'+dataList.workshop_name+'</h3>' +
            '<i class="iconfont">&#xe6b2;<span class="gz-zuozhei">'+dataList.membership+'</span></i>' +
            '<i class="iconfont">&#xe6b3;<span class="gz-pageview">'+dataList.pageviews+'</span></i>' +
            '</div>' +
            '</div>' +
            '<p class="gz-specialties">'+dataList.describe+'</p>' +
            '</div>' +
            '</div>'
        $('#swiper-wrapper1').append(li);
        //初始化Swiper
        var mySwiper = new Swiper('.swiper-container', {
            // observer:true,//修改swiper自己或子元素时，自动初始化swiper
            // observeParents:true,//修改swiper的父元素时，自动初始化swiper
            autoplay: true,//可选选项，自动滑动
            initialSlide :1,
            loop: true,
            effect: 'coverflow',
            slidesPerView: 1.2,
            centeredSlides: true,
            coverflowEffect: {
                rotate: 10,
                stretch: -30,
                depth: 100,
                modifier: 1,
                slideShadows: false
            },
        })
    };
    //智库成果
    axget('http://rap2api.taobao.org/app/mock/83971/think_tank_type', {'role':'001'},
        //请求成功返回数据
        function(data){
            if(data.read==200){
                $.each(data.data, function (i, v) {
                    var active='';
                    if (i==0){
                        active='active';
                        thinkTankType(data.data[i],active)
                    }else {
                        active='';
                        thinkTankType(data.data[i],active)
                    }
                });
            }
        },
        //请求出错了
        function(){alert("请求出错了")}
    );

    function thinkTankType(dataList,active) {
        var typeid=dataList.typeid;
        var type='<a href="#'+typeid+'" data-id='+typeid+' class="tab-link button '+active+' ">项目</a>';
        $('.gz-hdcg-tba').append(type)
    };

    // 友情链接
    axget('http://rap2api.taobao.org/app/mock/83971/blogroll', {'role':'001'},
        //请求成功返回数据
        function(data){
            $.each(data.organization, function (i, v) {
                blogroll(data.organization[i]);
            });
        },
        //请求出错了
        function(){alert("请求出错了")}
    );
    function blogroll(dataList) {
        var yqlj='<div data-rul='+dataList.url+' class="col-33">' +
            '<div  class="gz-blogroll-school">' +
            '<img src='+dataList.logo+'>' +
            '<h4 class="gz-blogroll-name">'+dataList.name+'</h4>' +
            '</div>' +
            '</div>'
        $('.gz-row-demo').append(yqlj)
    };
    //主办方
    axget('http://rap2api.taobao.org/app/mock/83971/sponsor', {'role':'001'},
        //请求成功返回数据
        function(data){
            $.each(data.undertaker, function (i, v) {
                sponsor(data.undertaker[i]);
            });
            $.each(data.frontfor, function (i, v) {
                auspice(data.frontfor[i]);
            });
        },
        //请求出错了
        function(){alert("请求出错了")}
    );
    function sponsor(dataList) {
        var undertaker='<a href="'+dataList.url+'"><img src='+dataList.logo+'></a>'
        $('.gz-undertaker').append(undertaker)
    };
    function auspice(dataList) {
        var frontfor='<a href="'+dataList.url+'">'+dataList.name+'</a>'
        $('.gz-sponsor').append(frontfor)
    };
    //成果展示
    axget('http://rap2api.taobao.org/app/mock/83971/results_statistical', {'role': '001'},
        //请求成功返回数据
        function (data) {
            var category = [];
            var score = [];
            $.each(data.achievements, function (i, v) {
                category.push(data.achievements[i].category)
                score.push(data.achievements[i].score)
            });
            resultsStatistical(category, score)
        },
        //请求出错了
        function () {
            alert("请求出错了")
        }
    );
    function resultsStatistical(category, score) {
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));
        // 指定图表的配置项和数据
        var option = {
            title: {
                text: '活动统计数',
                subtext: '统计量',
                textStyle: {fontSize: 16}
            },
            grid: {
                top: 80,
            },

            xAxis: [
                {
                    type: 'category',
                    data: category,
                    axisLine: {show: false},
                    axisTick: {show: false},
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLine: {show: false},
                    axisTick: {show: false},
                    splitNumber: 3,

                },
            ],
            series: [
                {
                    type: 'bar',
                    data: score,
                    barWidth: 5,
                    color: '#e73f19',
                    label: {
                        show: true,
                        position: 'top',
                        width: 15,
                        height: 15,
                        borderRadius: 300,
                        backgroundColor: '#fff',
                        borderColor: '#42c5fd',
                        borderWidth: 5,
                        color: '#fff',
                        distance: -0,
                        formatter: [
                            ' ',
                        ].join('\n'),
                        rich: {
                            a: {
                                color: '#fff',
                            },
                        },
                    },
                },
                {
                    type: 'bar',
                    data: score,
                    barWidth: 5,
                    color: '#42c5fd',
                    label: {
                        show: true,
                        position: 'top',
                        padding: 5,
                        borderRadius: 300,
                        backgroundColor: {
                            image: 'img/sia.png'
                        },
                        color: '#fff',
                        distance: 0,
                        fontStyle: 'normal',
                        offset: [25, 5]
                    },
                    barGap: '-100%',
                }
            ]
        };
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    };
    //初始化成果列表
    tankResults()
});

    $('.gz-hdcg-tba').on('click','.tab-link',function (){
        layer.msg('hello');
        $('.gz-hdcg-tba').find('.tab-link').removeClass('active');
        $(this).addClass('active');
        var typeid=$(this).attr('data-id');
        var div='<div id='+typeid+' class="tab active">' +
            '<div class="content-block gz-results"></div>' +
            '</div>'
        $('.gz-tabs').html(div);
        tankResults()
    });

    function tankResults() {
        axget('http://rap2api.taobao.org/app/mock/83971/thinkresults', {'role':'001'},
            //请求成功返回数据
            function(data){
                if(data.read==200){
                    $.each(data.resultslist, function (i, v) {
                        resultsListf(data.resultslist[i])
                    })
                }
            },
            //请求出错了
            function(){alert("请求出错了")}
        );
    };


    function resultsListf(dataList) {
        var state=dataList.state;
        var gzstate='';
        if(state==1){
            gzstate='<span class="gz-state gz-ywj">已完结</span>'
        }else if(state==2){
            gzstate='<span class="gz-state gz-jxz">进行中</span>'
        }else{
            gzstate='<span class="gz-state gz-wks">未开始</span>'
        }
        var results='<div class="gz-details">' +
            '<div class="card facebook-card">' +
            '<div class="card-header no-border">' +
            '<div class="facebook-avatar"><img src="'+dataList.Portraits+'"></div>' +
            '<div class="facebook-name"><b class="facebook-nametiet">'+dataList.headline+'</b>' +
            ''+gzstate+' '+
            '</div>' +
            '<div class="facebook-date">发起人:<span>'+dataList.initiator+'</span> 参与人:<span>'+dataList.participants+'</span></div>' +
            '</div>' +
            '<div class="card-content">' +
            '<p class="gz-cgtz">'+dataList.describe+'</p>' +
            '</div>' +
            '</div>' +
            '</div>'
        $('.gz-tabs').find('.gz-results').append(results);
    };

</script>
</body>
</html>