<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
	<link href="../css/mui.min.css" rel="stylesheet" type="text/css">
	<link href="../css/w-custom.css" rel="stylesheet" type="text/css">
	<link href="../css/mui.picker.min.css" rel="stylesheet" type="text/css">
	<script type="text/javascript" src="../js/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="../js/mui.min.js"></script>
	<script type="text/javascript" src="../js/mui.picker.min.js"></script>

</head>
<body class="mui-ios mui-ios-9 mui-ios-9-1">
<input type="hidden" id="pageIndex" value="1">
<script type="text/javascript">
    //顶部选择
    (function ($, doc) {
        $.init();
        $.ready(function () {
            /**
             * 获取对象属性的值
             * 主要用于过滤三级联动中，可能出现的最低级的数据不存在的情况，实际开发中需要注意这一点；
             * @param {Object} obj 对象
             * @param {String} param 属性名
             */
            var _getParam = function (obj, param) {
                return obj[param] || '';
            };
//一级选择
            var userPicker = new $.PopPicker();
            userPicker.setData([
                <!-- 活动环节 -->
                {
                       text: '情景导入'
                }
                , {
                      text: '主题研讨'
                }
                , {
                       text: '课程学习'
                }
                , {
                     text: '课程学习2'
                }
                , {
                      text: '作业'
                }
                , {
                     text: '活动成果'
                }
                , {
                      text: '互动答疑'
                }
                , {
                      text: '讨论区'
                }
                , {
                      text: '组长小结'
                }
                , {
                     text: '坊主小结'
                }
                , {
                       text: '课例观摩'
                }
                , {
                      text: '活动研讨室'
                }
                , {
                      text: '2+2互评'
                }
            ]);
            var showUserPickerButton = doc.getElementById('showUserPicker');
            var userResult = doc.getElementById('userResult');
            showUserPickerButton.addEventListener('tap', function (event) {
                userPicker.show(function (items) {
                    userResult.innerText = items[0].text;
                    //location.href = items[0].url;
//JSON.stringify(test);
//items[0].text
//返回 false 可以阻止选择框的关闭
//return false;
                });
            }, false);
//-----------------------------------------
        });
    })(mui, document);
</script>
<header class="mui-bar mui-bar-nav mui-bar-transparent w-subject-color" data-top="0" data-offset="150"
		data-duration="16" data-scrollby=".mui-scroll-wrapper" style="background-color: rgba(48, 63, 159, 0.96);">
	<a style="padding: 10px 0;" href="javascript:history.back();"><i class="iconfont w-back"></i></a>
	<h1 id="showUserPicker" class="mui-title"><span id="userResult" class="w-act-title">课程学习</span><i class="iconfont "></i>
	</h1>
</header>
<div style="margin-top:45px;"></div>
<input type="hidden" id="sType" value="resource">
<input type="hidden" id="mType" value="other">
<!--新增描述-->
<div class="w-describe">
	<h5>课程学习 <span>编辑描述</span></h5>
	<p class="w-description">录取他口头语音吗谢谢好的好的哟哟切克闹别跟我似的小时候只能吃到面和土豆，长大了别的也吧爱吃别跟我似的小时候只能吃到面和土豆，长大了别的也吧爱吃</p>
</div>
<!--新增描述-->
<div class="w-ineedall mui-row">
	<div class="mui-col-sm-12 mui-col-xs-12">
		<div class="w-came w-kcgl">
			<p>未学习<span >292人</span>正在学习<span >0人</span>已经完成学习<span >0人</span></p>
			<div class="w-xzkc">
				<span>注： 您已经选择了<b>3</b>门课程。</span>
				<button type="button" class="mui-btn mui-btn-primary" >选择课程</button>
				<button type="button" class="mui-btn mui-btn-warning" >课程管理</button></div>

		</div>
	</div>
</div>

<div class="w-performance">
	<ul class="mui-table-view w-table-view">
		<!--<li class="mui-table-view-cell mui-media">
			<a href="javascript:;">

				<div class="mui-media-body">
					课程名称
					<p class='mui-ellipsis'><em> 已学:6分钟</em> <em>课时:60分钟</em> <em>学时:5分钟</em> <em>进度:100%</em></p>
				</div>
				<div class="w-kcxxbj">
					<button type="button" class="mui-btn ">课程笔记</button>
					<button type="button" class="mui-btn mui-btn-primary">学习课程</button>
				</div>
			</a>
		</li>-->
		<li class="mui-table-view-cell mui-media">
			<a href="javascript:;">
				<div class="mui-media-body">
					课程名称
					<p class='mui-ellipsis'>
						<em> 2分钟<br/>已学时间</em>
						<em> 15分钟<br/>满分学时</em>
						<em> 5分钟<br/>最低学时</em>
						<em> 10%<br/>完成进度 </em></p>
				</div>
				<div class="w-kcxxbj">
					<button type="button" class="mui-btn ">课程笔记</button>
					<button type="button" class="mui-btn mui-btn-primary">学习课程</button>
				</div>
			</a>
		</li>
		<li class="mui-table-view-cell mui-media">
			<a href="javascript:;">

				<div class="mui-media-body">
					课程名称
					<p class='mui-ellipsis'>
						<em> 2分钟<br/>已学时间</em>
						<em> 15分钟<br/>满分学时</em>
						<em> 5分钟<br/>最低学时</em>
						<em> 10%<br/>完成进度 </em></p>


				</div>
				<div class="w-kcxxbj">
					<button type="button" class="mui-btn ">课程笔记</button>
					<button type="button" class="mui-btn mui-btn-primary">学习课程</button>
				</div>
			</a>
		</li>
		<li class="mui-table-view-cell mui-media">
			<a href="javascript:;">

				<div class="mui-media-body">
					课程名称
					<p class='mui-ellipsis'>
						<em> 2分钟<br/>已学时间</em>
						<em> 15分钟<br/>满分学时</em>
						<em> 5分钟<br/>最低学时</em>
						<em> 10%<br/>完成进度 </em></p>


				</div>
				<div class="w-kcxxbj">
					<button type="button" class="mui-btn ">课程笔记</button>
					<button type="button" class="mui-btn mui-btn-primary">学习课程</button>
				</div>
			</a>
		</li>
	</ul>
</div>

<!--新增上传结束-->

<!--新增编辑描述-->
<div class="w-desc-mask">

	<div class="w-describe-text">

		<textarea maxlength="300" rows="5" placeholder="编辑描述" autofocus="autofocus"></textarea>
		<a>提交</a>
		<span>300</span>

	</div>
</div>
<!--新增编辑描述结束-->


<script>
    $(function(){
        $(".w-describe span").click(function(event){
            var e=window.event || event;
            if(e.stopPropagation){
                e.stopPropagation();
            }else{
                e.cancelBubble = true;
            }
            $(".w-describe-text").show();
            $(".w-desc-mask").show();

        });
        $(".w-describe-text").click(function(event){
            var e=window.event || event;
            if(e.stopPropagation){
                e.stopPropagation();
            }else{
                e.cancelBubble = true;
            }
        });
        document.onclick = function(){
            $(".w-describe-text").hide();
            $(".w-desc-mask").hide();
        };
    })

</script>
<script>
    $(function(){
        //先选出 textarea 和 统计字数 dom 节点
        var wordCount = $(".w-describe-text"),
            textArea = wordCount.find("textarea"),
            word = wordCount.find("span"),
            supa = wordCount.find("a");

        textArea.val($(".w-description").text());
        var textval=textArea.val();
        if (textval.length>0){
            $('.w-describe-text a').addClass("active");
        }else{
            $('.w-describe-text a').removeClass("active");
        }
        //调用
        statInputNum(textArea,word);

        $(".w-describe-text a").click(function(){

            $(".w-description").text(textval);
            $(".w-desc-mask").hide();
            $(".w-describe-text").hide();
        });

    });
	/*
	 * 剩余字数统计
	 * 注意 最大字数只需要在放数字的节点哪里直接写好即可 如：<var class="word">200</var>
	 */
    function statInputNum(textArea,numItem) {
        var max = numItem.text(),
            curLength;
        textArea[0].setAttribute("maxlength", max);
        curLength = textArea.val().length;
        numItem.text(max - curLength);
        textArea.on('input propertychange', function () {
            var _value = $(this).val().replace(/\n/gi,"");
            numItem.text(max - _value.length);
            var textval=textArea.val();
            if (textval.length>0){
                $('.w-describe-text a').addClass("active");
            }else{
                $('.w-describe-text a').removeClass("active");
            }
            $(".w-describe-text a").click(function(){

                $(".w-description").text(textval);
            });
        });
    }

</script>
</body>
</html>