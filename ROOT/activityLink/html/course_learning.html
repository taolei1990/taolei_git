<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!--<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"  name="viewport" />-->
    <title>Title</title>
    <link href="../css/animate.min.css" rel="stylesheet" type="text/css">
    <script src="../../js/common.js"></script>
    <style>
        *{ margin: 0; padding: 0; }

        li{ list-style-type: none; }

        .bagtime{ display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(35, 35, 35, 0.29);}

        .timecounter{ width: 100%; position: fixed; bottom: 0; left: 0; right: 0; zoom: 2.5; border-top: 1px solid #e9e9e9;}

        #txtTime{ color: #f52400; }

        .y-takenotes{ color: #fff; background-color: #f7754f; border-radius: 55px; position: fixed; right: 10px; bottom: 24px; width: 60px; height: 60px; text-align: center; line-height: 60px; animation-iteration-count: 3; }

        .takenTime{ background-color: #fbfbfb; display: flex; display: -webkit-flex; justify-content: space-between; align-items: center; }

        .y-takenotes-list{ background-color: #fff; display: none; }

        .y-textarea{ display: flex; display: -webkit-flex; justify-content: space-between; align-items: center; }

        .y-xbjiput textarea{ width: 100%; height: 34px; padding: 10px; border: none; }

        .y-xbjiput{ flex-grow: 1; }

        .y-quxiao{ color: #232323; float: right; }

        .y-tijiao{ color: #989898; width: 74px; height: 54px; }

        .y-tijiao a{ float: right; display: block; width: 54px; line-height: 54px; line-height: 54px; text-align: center; color: #0f82fd; opacity: 0.4; }

        .y-tijiao a.active{ opacity: 1; }

        .y-bjlist{ background-color: #fbfbfb; padding: 10px; }

        .y-bjlistp{ font-size: 12px; color: #989898; background-color: #fff; padding: 10px; border-bottom: 1px solid #ececec; }

        .y-touximg img{ width: 32px; height: 32px; float: left; border-radius: 55px; margin-right: 10px; }

        .y-overflow{ max-height: 400px; overflow-y: auto; }

        .y-bjlist li{ display: flex; display: -webkit-flex; padding: 10px 0 0 0; }

        .y-bjnongr b{ float: left; font-weight: 500; color: #0f82fd; margin-right: 10px; line-height: 32px; }

        .y-bjnongr span{ float: left; font-size: 14px; color: #989898; margin-right: 10px; line-height: 32px; }

        .y-bjnongr p{ clear: both; line-height: normal; border-bottom: 1px solid #ececec; padding: 5px 0 15px 0; }

        .timezs{ color: #989898; font-size: 12px; }

        .timezs span{ margin: 0 5px; color: #989898; }

        .ljxutaken{ padding: 10px; }
    </style>

    <script src="../js/jquery-3.2.1.min.js"></script>

</head>
<body onload="startTime()">
<iframe src="http://edu6.teacher.com.cn/yunnan/ttbjx114a/index.htm" frameBorder=0 style="height: 100vh"
        width="100%"></iframe>
<div class="bagtime"></div>
<div class="timecounter top">
    <div class="takenTime">
        <div class="ljxutaken">
            <div id="txtTime">累计学习时间 ：00:00:00</div>
            <p class="timezs">至少学习30分钟<span> (每学习满1分钟为有效学习时间) </span></p>
        </div>
        <div class="y-takenotes animated pulse">笔记</div>
    </div>
    <div class="y-takenotes-list ">
        <p class="y-bjlistp"><span class="y-qbtshu">全部笔记0条</span> <span class="y-quxiao">取消</span></p>
        <div class="y-overflow">
            <ul class="y-bjlist">
                <!--<li>-->
                <!--<div class="y-touximg">-->
                <!--<img src="../img/59d8ba85c3512c0731448bd03cf40a84.png">-->
                <!--</div>-->
                <!--<div class="y-bjnongr">-->
                <!--<b>陶老师 </b><span>3天前</span>-->
                <!--<p>笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记</p>-->
                <!--</div>-->
                <!--</li>-->
                <!--<li>-->
                <!--<div class="y-touximg">-->
                <!--<img src="../img/59d8ba85c3512c0731448bd03cf40a84.png">-->
                <!--</div>-->
                <!--<div class="y-bjnongr">-->
                <!--<b>陶老师 </b><span>3天前</span>-->
                <!--<p>笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记</p>-->
                <!--</div>-->

                <!--</li>-->
                <!--<li>-->
                <!--<div class="y-touximg">-->
                <!--<img src="../img/59d8ba85c3512c0731448bd03cf40a84.png">-->
                <!--</div>-->
                <!--<div class="y-bjnongr">-->
                <!--<b>陶老师 </b><span>3天前</span>-->
                <!--<p>笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记-->
                <!--笔记笔记笔记笔记笔记笔记</p>-->
                <!--</div>-->

                <!--</li>-->
            </ul>
        </div>

        <div class="y-textarea">
            <div class="y-xbjiput">
                <textarea id="my-textarea" placeholder="写笔记"></textarea></div>
            <div class="y-tijiao"><a>提交</a></div>
        </div>
    </div>
</div>
<script>
    function startTime() {
        var seconds = addTime();
        var hours = 0;
        var mins = 0;
        if (seconds < 60) {

        } else if (seconds < 3600) {
            mins = parseInt(seconds / 60);
            seconds = seconds % 60;

        } else {
            mins = parseInt(seconds / 60)
            seconds = seconds % 60
            hours = parseInt(mins / 60)
            mins = mins % 60

        }
        // add a zero in front of numbers<10
        hours = checkTime(hours)
        mins = checkTime(mins)
        seconds = checkTime(seconds)
        document.getElementById('txtTime').innerHTML = '已学习时间 ：' + hours + ":" + mins + ":" + seconds;
        if (seconds == "00") {
            var data = {
                activityId: getUrlParamValue("activityId"),
                tacheType: getUrlParamValue("tacheType"),
                classId: getUrlParamValue("classId"),
                sTime: 1,   // 每次固定一分钟提交
                startTime: getNowFormatDate()
            };
            post("/activity/course/addStime", data, function (res) {
                if (res.code != 200)
                    mui.toast(res, message)
            })
        }
        setTimeout('startTime()', 1000);

    }

    // 当前时间
    function getNowFormatDate() {
        var date = new Date();
        var seperator1 = "-";
        var seperator2 = ":";
        var month = date.getMonth() + 1;
        var strDate = date.getDate();
        if (month >= 1 && month <= 9) {
            month = "0" + month;
        }
        if (strDate >= 0 && strDate <= 9) {
            strDate = "0" + strDate;
        }
        var hours = date.getHours();
        if (hours >= 0 && hours <= 9) {
            hours = "0" + hours;
        }
        var minute = date.getMinutes();
        if (minute >= 0 && minute <= 9) {
            minute = "0" + minute;
        }
        var second = date.getSeconds();
        if (second >= 0 && second <= 9) {
            second = "0" + minute;
        }
        var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + hours + seperator2 + minute
            + seperator2 + second;
        return currentdate;
    }

    var seconds = 0;//传入时间
    get("/activity/course/getStime?activityId=" + getUrlParamValue("activityId") + "&tacheType=" + getUrlParamValue("tacheType") + "&classId=" + getUrlParamValue("classId"), function (res) {
        if (res.code == 200) {
            seconds = res.data.studyTime * 60;
        } else {
            mui.toast(res.message)
        }
    });

    function addTime() //在线时间
    {
        seconds += 1;
        return seconds;
    }

    function checkTime(i)//数值转换函数
    {
        if (i < 10) {
            i = "0" + i
        }
        return i
    }
</script>
<script>
    $(function () {
        get("/activity/course/detail?activityId=" + getUrlParamValue("activityId") +
            "&courseId=" + getUrlParamValue("courseId") +
            "&actCourseId=" + getUrlParamValue("classId"), function (res) {
            if (res.code == 200) {
                var list = res.data.noteList;
                $(".y-qbtshu").html("全部笔记" + res.data.total + "条");
                var li = '';
                if (Object_filter(list)) {
                    for (var i = 0; i < list.length; i++) {
                        li += '<li><div class="y-touximg"><img src="' + list[i].headImg + '"></div><div class="y-bjnongr"><b>' + list[i].name + '</b><span>' + list[i].createDate + '</span><p>' + list[i].title + '</p></div></li>';
                    }
                }
                $(".y-bjlist").append(li);
            }
        })
    });
    //弹出评价
    $(".takenTime").on("click", ".y-takenotes", function () {
        $('.takenTime').hide();
        $('.y-takenotes-list').show();
        $('.bagtime').show();
    });
    //取消
    $(".y-takenotes-list").on("click", ".y-quxiao", function () {
        $('.takenTime').show();
        $('.y-takenotes-list').hide();
        $('.bagtime').hide();
    });
    //提交
    $(".y-takenotes-list").on("click", ".y-tijiao", function () {
        var s = $('#my-textarea').val();
        console.log(s);
    });

    $('textarea').bind('input propertychange', function () {
        if ($("#my-textarea").val() != "") {
            $(".y-tijiao a").addClass("active");
        } else {
            $(".y-tijiao a").removeClass("active");
        }
    });
</script>
<script>
    $(document).click(function (e) {
        var divTop = $('.top');   // 设置目标区域
        if (!divTop.is(e.target) && divTop.has(e.target).length === 0) {
            console.log('点击空白处成功')
            $('.takenTime').show();
            $('.y-takenotes-list').hide();
            $('.bagtime').hide();
        }
    })
</script>
</body>
</html>